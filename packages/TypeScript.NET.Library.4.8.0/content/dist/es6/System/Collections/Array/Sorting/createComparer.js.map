{"version":3,"sources":["System/Collections/Array/Sorting/createComparer.ts"],"names":[],"mappings":"AAAA;;;GAGG;AACH,OAAO,EAAC,IAAI,EAAC,MAAM,gBAAgB,CAAC;AACpC,OAAO,EAAC,OAAO,EAAC,MAAM,kBAAkB,CAAC;AAMzC,qBAAwB,KAAW;IAElC,MAAM,CAAC,CAAC,KAAK,CAAC,YAAU,CAAC,KAAK,CAAC;UACvB,KAAK;UACV,CAAI,KAAK,CAAC,CAAC;AACf,CAAC;AAED;;;;;;;;;;;;;;;;;;;;;;GAsBG;AACH,MAAM,yBACL,QAA4C,EAC5C,QAAwB,iBAAe,EACvC,kBAAsB,GAAG;IAEzB,MAAM,gBAAgB,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;IAE1D,MAAM,CAAC,CAAC,CAAS,EAAE,CAAS;QAE3B,oDAAoD;QACpD,MAAM,MAAM,GAAG,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QACxC,MAAM,MAAM,GAAG,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QACxC,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;QAEnD,MAAM,MAAM,GAAG,CAAC,KAAK,CAAC,YAAU,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC;QACvD,GAAG,CAAA,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAC,GAAG,EAAE,CAAC,EAAE,EACzB,CAAC;YACA,IAAI,EAAE,GAAG,MAAM,CAAC,CAAC,CAAC,EACd,EAAE,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,GAAG,MAAM;kBACb,CAAC,CAAC,GAAC,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,GAAG,iBAAe,CAAC;kBACxC,KAAK,CAAC;YAEhB,EAAE,CAAA,CAAC,gBAAgB,CAAC,CACpB,CAAC;gBACA,EAAE,CAAA,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;oBACrB,EAAE,GAAG,eAAe,CAAC;gBACtB,EAAE,CAAA,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;oBACrB,EAAE,GAAG,eAAe,CAAC;YAEvB,CAAC;YAED,MAAM,CAAC,GAAG,OAAO,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;YAC1B,EAAE,CAAA,CAAC,CAAC,KAAG,aAAmB,CAAC;gBAC1B,MAAM,CAAC,CAAC,GAAC,CAAC,CAAC;QAEb,CAAC;QAED,MAAM,CAAC,CAAC,CAAC;IACV,CAAC,CAAC;AACH,CAAC","file":"createComparer.js","sourcesContent":["/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Licensing: MIT https://github.com/electricessence/TypeScript.NET/blob/master/LICENSE.md\r\n */\r\nimport {Type} from \"../../../Types\";\r\nimport {compare} from \"../../../Compare\";\r\nimport {Primitive} from \"../../../Primitive\";\r\nimport {Selector, Comparison} from \"../../../FunctionTypes\";\r\nimport {CompareResult} from \"../../../CompareResult\";\r\nimport {Order} from \"../../Sorting/Order\";\r\n\r\nfunction ensureArray<T>(value:T|T[]):T[]\r\n{\r\n\treturn (value)instanceof(Array)\r\n\t\t? <T[]>value\r\n\t\t: [<T>value];\r\n}\r\n\r\n/**\r\n * A factory function that creates a comparer to be used in multi-dimensional sorting.\r\n *\r\n * <h4>Example</h4>\r\n * ```typescript\r\n * var myArray = [{a:1:b:2},{a:3,b:4},{a:1,b:3}];\r\n *\r\n * // First sort by a, then by b.\r\n * myArray.sort(\r\n *   createComparer(\r\n *     (e)=> [e.a, e.b],\r\n *     [Order.Ascending, Order.Descending]\r\n *   )\r\n * );\r\n *\r\n * // result: [{a:1,b:3},{a:1:b:2},{a:3,b:4}]\r\n * ```\r\n *\r\n * @param selector\r\n * @param order\r\n * @param equivalentToNaN\r\n * @returns {(a:TSource, b:TSource)=>CompareResult}\r\n */\r\nexport function createComparer<TSource,TSelect extends Primitive>(\r\n\tselector:Selector<TSource,TSelect|TSelect[]>,\r\n\torder:Order | Order[] = Order.Ascending,\r\n\tequivalentToNaN:any = NaN):Comparison<TSource>\r\n{\r\n\tconst nanHasEquivalent = !Type.isTrueNaN(equivalentToNaN);\r\n\r\n\treturn (a:TSource, b:TSource):CompareResult=>\r\n\t{\r\n\t\t// Use an array always to ensure a single code path.\r\n\t\tconst aValue = ensureArray(selector(a));\r\n\t\tconst bValue = ensureArray(selector(b));\r\n\t\tconst len = Math.min(aValue.length, bValue.length);\r\n\r\n\t\tconst oArray = (order)instanceof(Array) ? order : null;\r\n\t\tfor(let i = 0; i<len; i++)\r\n\t\t{\r\n\t\t\tlet vA = aValue[i],\r\n\t\t\t    vB = bValue[i];\r\n\t\t\tconst o = oArray\r\n\t\t\t\t? (i<oArray.length ? oArray[i] : Order.Ascending)\r\n\t\t\t\t: <Order>order;\r\n\r\n\t\t\tif(nanHasEquivalent)\r\n\t\t\t{\r\n\t\t\t\tif(Type.isTrueNaN(vA))\r\n\t\t\t\t\tvA = equivalentToNaN;\r\n\t\t\t\tif(Type.isTrueNaN(vB))\r\n\t\t\t\t\tvB = equivalentToNaN;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst r = compare(vA, vB);\r\n\t\t\tif(r!==CompareResult.Equal)\r\n\t\t\t\treturn o*r;\r\n\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\t};\r\n}\r\n\r\n"]}