{"version":3,"sources":["System/Collections/LazyList.ts"],"names":[],"mappings":"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","file":"LazyList.js","sourcesContent":["/*!\r\n * @author electricessence / https://github.com/electricessence/\r\n * Origin: http://www.fallingcanbedeadly.com/\r\n * Licensing: MIT\r\n */\r\nimport {IEnumerator} from \"./Enumeration/IEnumerator\";\r\nimport {ReadOnlyCollectionBase} from \"./ReadOnlyCollectionBase\";\r\nimport {IEnumerable} from \"./Enumeration/IEnumerable\";\r\nimport {Action} from \"../FunctionTypes\";\r\nimport {IReadOnlyList} from \"./IList\";\r\nimport {ArgumentOutOfRangeException} from \"../Exceptions/ArgumentOutOfRangeException\";\r\nimport {EnumeratorBase} from \"./Enumeration/EnumeratorBase\";\r\nimport __extendsImport from \"../../extends\";\r\nimport {Integer} from \"../Integer\";\r\n// noinspection JSUnusedLocalSymbols\r\nconst __extends = __extendsImport;\r\n\r\nexport class LazyList<T> extends ReadOnlyCollectionBase<T> implements IReadOnlyList<T>\r\n{\r\n\r\n\tprivate _enumerator:IEnumerator<T>|null;\r\n\tprivate _cached:T[]|null;\r\n\r\n\tconstructor(source:IEnumerable<T>)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._enumerator = source.getEnumerator();\r\n\t\tthis._cached = [];\r\n\t}\r\n\r\n\tprotected _onDispose():void\r\n\t{\r\n\t\tsuper._onDispose();\r\n\t\tconst e = this._enumerator;\r\n\t\tthis._enumerator = null;\r\n\t\tif(e) e.dispose();\r\n\r\n\t\tconst c = this._cached;\r\n\t\tthis._cached = null;\r\n\t\tif(c) c.length = 0;\r\n\t}\r\n\r\n\tprotected _getCount():number\r\n\t{\r\n\t\tthis.finish();\r\n\t\tconst c = this._cached;\r\n\t\treturn c ? c.length : 0;\r\n\t}\r\n\r\n\tprotected _getEnumerator():IEnumerator<T>\r\n\t{\r\n\t\tlet current:number;\r\n\t\treturn new EnumeratorBase<T>(\r\n\t\t\t()=>{\r\n\t\t\t\tcurrent = 0;\r\n\t\t\t},\r\n\t\t\tyielder =>\r\n\t\t\t{\r\n\t\t\t\tthis.throwIfDisposed();\r\n\t\t\t\tconst c = this._cached!;\r\n\t\t\t\treturn (current<c.length || this.getNext())\r\n\t\t\t\t\t? yielder.yieldReturn(c[current++])\r\n\t\t\t\t\t: yielder.yieldBreak();\r\n\t\t\t});\r\n\t}\r\n\r\n\tget(index:number):T\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tInteger.assertZeroOrGreater(index);\r\n\r\n\t\tconst c = this._cached!;\r\n\t\twhile(c.length<=index && this.getNext())\r\n\t\t{}\r\n\r\n\t\tif(index<c.length)\r\n\t\t\treturn c[index];\r\n\r\n\t\tthrow new ArgumentOutOfRangeException(\"index\", \"Greater than total count.\");\r\n\t}\r\n\r\n\tindexOf(item:T):number\r\n\t{\r\n\t\tthis.throwIfDisposed();\r\n\t\tconst c = this._cached!;\r\n\t\tlet result = c.indexOf(item);\r\n\t\twhile(result== -1 && this.getNext(value =>\r\n\t\t{\r\n\t\t\tif(value==item)\r\n\t\t\t\tresult = c.length - 1;\r\n\t\t}))\r\n\t\t{}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tcontains(item:T):boolean\r\n\t{\r\n\t\treturn this.indexOf(item)!=-1;\r\n\t}\r\n\r\n\tprivate getNext(out?:Action<T>):boolean\r\n\t{\r\n\t\tconst e = this._enumerator;\r\n\t\tif(!e) return false;\r\n\t\tif(e.moveNext())\r\n\t\t{\r\n\t\t\tconst value = e.current!;\r\n\t\t\tthis._cached!.push(value);\r\n\t\t\tif(out) out(value);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\te.dispose();\r\n\t\t\tthis._enumerator = <any>null;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\r\n\tprivate finish():void\r\n\t{\r\n\t\twhile(this.getNext())\r\n\t\t{}\r\n\t}\r\n\r\n\r\n}"]}